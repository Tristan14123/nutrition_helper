<!DOCTYPE html>
<html lang="fr">
<head>
    <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#764ba2">
<script>

// Pr√©-remplissage des champs si donn√©es enregistr√©es
window.addEventListener('DOMContentLoaded', () => {
    const savedProfile = JSON.parse(localStorage.getItem('userProfile'));
    if (savedProfile) {
        document.getElementById('age').value = savedProfile.age;
        document.getElementById('weight').value = savedProfile.weight;
        document.getElementById('height').value = savedProfile.height;
        document.getElementById('activity').value = savedProfile.activity;
        document.getElementById('goal').value = savedProfile.goal;

        const genderInputs = document.querySelectorAll('input[name="gender"]');
        genderInputs.forEach(input => {
            input.checked = input.value === savedProfile.gender;
        });
    }
});



  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("service-worker.js")
        .then(reg => console.log("‚úÖ Service worker enregistr√©", reg))
        .catch(err => console.error("‚ùå Service worker √©chou√©", err));
    });
  }
    
</script>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutrition Helper - Votre assistant nutritionnel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .nutri-circle {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
        .slide-in {
            animation: slideIn 0.5s forwards;
        }
        @keyframes slideIn {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <header class="gradient-bg text-white shadow-lg">
        <div class="container mx-auto px-4 py-6">
            <div class="flex justify-between items-center">
                <h1 class="text-3xl font-bold"><i class="fas fa-utensils mr-2"></i>Nutrition Helper</h1>
                <button id="infoBtn" class="text-white hover:text-gray-200">
                    <i class="fas fa-info-circle text-2xl"></i>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <!-- Formulaire de profil -->
        <section class="bg-white rounded-xl shadow-md p-6 mb-8 slide-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-4"><i class="fas fa-user-circle mr-2 text-purple-600"></i>Votre profil</h2>
            <form id="profileForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div>
                    <label for="age" class="block text-sm font-medium text-gray-700 mb-1">√Çge</label>
                    <input type="number" id="age" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="30" required>
                </div>
                <div>
                    <label for="weight" class="block text-sm font-medium text-gray-700 mb-1">Poids (kg)</label>
                    <input type="number" id="weight" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="70" required>
                </div>
                <div>
                    <label for="height" class="block text-sm font-medium text-gray-700 mb-1">Taille (cm)</label>
                    <input type="number" id="height" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="175" required>
                </div>
                <div>
                    <label for="activity" class="block text-sm font-medium text-gray-700 mb-1">Activit√© physique</label>
                    <select id="activity" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        <option value="1.2">S√©dentaire (peu ou pas d'exercice)</option>
                        <option value="1.375">L√©g√®rement actif (1-3 jours/semaine)</option>
                        <option value="1.55">Mod√©r√©ment actif (3-5 jours/semaine)</option>
                        <option value="1.725">Tr√®s actif (6-7 jours/semaine)</option>
                        <option value="1.9">Extr√™mement actif (sport intense quotidien)</option>
                    </select>
                </div>
                <div class="md:col-span-2">
                    <label for="gender" class="block text-sm font-medium text-gray-700 mb-1">Sexe</label>
                    <div class="flex space-x-4">
                        <label class="inline-flex items-center">
                            <input type="radio" name="gender" value="male" checked class="h-4 w-4 text-purple-600 focus:ring-purple-500">
                            <span class="ml-2 text-gray-700">Homme</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" name="gender" value="female" class="h-4 w-4 text-purple-600 focus:ring-purple-500">
                            <span class="ml-2 text-gray-700">Femme</span>
                        </label>
                    </div>
                </div>
                <div class="md:col-span-2">
                    <label for="goal" class="block text-sm font-medium text-gray-700 mb-1">Objectif</label>
                    <select id="goal" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500">
                        <option value="maintain">Maintenir mon poids</option>
                        <option value="lose">Perdre du poids</option>
                        <option value="gain">Prendre du poids</option>
                    </select>
                </div>
                <div class="md:col-span-4">
                    <button type="submit" class="w-full gradient-bg text-white py-3 px-6 rounded-lg font-semibold hover:opacity-90 transition duration-300 shadow-lg">
                        <i class="fas fa-calculator mr-2"></i>Calculer mes besoins
                    </button>
                </div>
            </form>
        </section>

        <!-- R√©sultats -->
        <section id="resultsSection" class="hidden bg-white rounded-xl shadow-md p-6 mb-8 slide-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-chart-line mr-2 text-purple-600"></i>Vos besoins nutritionnels</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-purple-50 rounded-lg p-6 border border-purple-100">
                    <h3 class="font-semibold text-purple-800 mb-2"><i class="fas fa-bolt mr-2"></i>Calories quotidiennes</h3>
                    <p class="text-3xl font-bold text-purple-600" id="caloriesResult">0</p>
                    <p class="text-sm text-gray-600 mt-2">Votre apport calorique journalier recommand√©</p>
                </div>
                <div class="bg-blue-50 rounded-lg p-6 border border-blue-100">
                    <h3 class="font-semibold text-blue-800 mb-2"><i class="fas fa-dumbbell mr-2"></i>Prot√©ines</h3>
                    <p class="text-3xl font-bold text-blue-600" id="proteinsResult">0g</p>
                    <p class="text-sm text-gray-600 mt-2">Soit <span id="proteinsPercent">0</span>% de vos calories</p>
                </div>
                <div class="bg-green-50 rounded-lg p-6 border border-green-100">
                    <h3 class="font-semibold text-green-800 mb-2"><i class="fas fa-bread-slice mr-2"></i>Glucides</h3>
                    <p class="text-3xl font-bold text-green-600" id="carbsResult">0g</p>
                    <p class="text-sm text-gray-600 mt-2">Soit <span id="carbsPercent">0</span>% de vos calories</p>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="bg-yellow-50 rounded-lg p-6 border border-yellow-100">
                    <h3 class="font-semibold text-yellow-800 mb-2"><i class="fas fa-cheese mr-2"></i>Lipides</h3>
                    <p class="text-3xl font-bold text-yellow-600" id="fatsResult">0g</p>
                    <p class="text-sm text-gray-600 mt-2">Soit <span id="fatsPercent">0</span>% de vos calories</p>
                </div>
                <div class="bg-red-50 rounded-lg p-6 border border-red-100">
                    <h3 class="font-semibold text-red-800 mb-2"><i class="fas fa-tint mr-2"></i>Eau</h3>
                    <p class="text-3xl font-bold text-red-600" id="waterResult">0L</p>
                    <p class="text-sm text-gray-600 mt-2">Quantit√© d'eau recommand√©e par jour</p>
                </div>
            </div>
        </section>

        <!-- Menus recommand√©s -->
        <section id="menusSection" class="hidden bg-white rounded-xl shadow-md p-6 slide-in">
            <h2 class="text-2xl font-bold text-gray-800 mb-6"><i class="fas fa-utensils mr-2 text-purple-600"></i>Menus recommand√©s</h2>
            
            <div class="mb-6">
                <h3 class="text-lg font-semibold text-gray-700 mb-3">R√©partition des repas</h3>
                <div class="grid grid-cols-1 sm:grid-cols-4 gap-4">
                    <div class="bg-indigo-100 rounded-lg p-4 text-center">
                        <p class="font-medium text-indigo-800">Petit-d√©jeuner</p>
                        <p class="text-sm text-gray-600"><span id="breakfastPercent">25</span>% des calories</p>
                    </div>
                    <div class="bg-blue-100 rounded-lg p-4 text-center">
                        <p class="font-medium text-blue-800">D√©jeuner</p>
                        <p class="text-sm text-gray-600"><span id="lunchPercent">35</span>% des calories</p>
                    </div>
                    <div class="bg-purple-100 rounded-lg p-4 text-center">
                        <p class="font-medium text-purple-800">Collation</p>
                        <p class="text-sm text-gray-600"><span id="snackPercent">15</span>% des calories</p>
                    </div>
                    <div class="bg-pink-100 rounded-lg p-4 text-center">
                        <p class="font-medium text-pink-800">D√Æner</p>
                        <p class="text-sm text-gray-600"><span id="dinnerPercent">25</span>% des calories</p>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="menuContainer">
                <!-- Les menus seront g√©n√©r√©s ici par JavaScript -->
            </div>
        </section>
    </main>

    <!-- Modal d'information -->
    <div id="infoModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">√Ä propos de Nutrition Helper</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="space-y-4 text-gray-700">
                <p>Cette application calcule vos besoins nutritionnels journaliers en fonction de votre profil (√¢ge, poids, taille, niveau d'activit√©) et vous propose des menus adapt√©s √† vos objectifs.</p>
                <p>Les calculs sont bas√©s sur :</p>
                <ul class="list-disc pl-5 space-y-2">
                    <li>L'√©quation de Mifflin-St Jeor pour le m√©tabolisme de base</li>
                    <li>Le niveau d'activit√© physique (facteur PAL)</li>
                    <li>Les recommandations de l'OMS pour la r√©partition des macronutriments</li>
                </ul>
                <p class="text-sm text-gray-500">Note : Ces recommandations sont indicatives. Consultez un professionnel de sant√© pour des conseils personnalis√©s.</p>
            </div>
        </div>
    </div>

    <footer class="gradient-bg text-white py-6 mt-12">
        <div class="container mx-auto px-4 text-center">
            <p>¬© 2025 Nutrition Helper - Votre assistant nutritionnel personnel</p>
            <p class="text-sm opacity-80 mt-2">Calculs bas√©s sur les recommandations de l'OMS et de la FDA</p>
        </div>
    </footer>

    <script>
        // Gestion du modal
        const infoBtn = document.getElementById('infoBtn');
        const infoModal = document.getElementById('infoModal');
        const closeModal = document.getElementById('closeModal');

        infoBtn.addEventListener('click', () => {
            infoModal.classList.remove('hidden');
        });

        closeModal.addEventListener('click', () => {
            infoModal.classList.add('hidden');
        });

          // Base de donn√©es des menus
const menusDatabase = {
    maintain: {
        breakfast: [
            {
                title: "Porridge prot√©in√©",
                calories: 350,
                description: "Flocons d'avoine, lait d'amande, banane, noix et graines",
                nutrients: "P : 15 g, G : 50 g, L : 10 g"
            },
            {
                title: "Omelette aux l√©gumes",
                calories: 400,
                description: "≈íufs, √©pinards, tomates, fromage de ch√®vre, pain complet",
                nutrients: "P : 25 g, G : 30 g, L : 18 g"
            },
            {
                title: "Toast ricotta et miel",
                calories: 380,
                description: "Pain complet, ricotta, miel, graines de lin",
                nutrients: "P : 18 g, G : 45 g, L : 12 g"
            },
            {
                title: "Bol muesli et fruits",
                calories: 420,
                description: "Muesli, lait v√©g√©tal, fruits frais, amandes",
                nutrients: "P : 20 g, G : 55 g, L : 15 g"
            }
        ],
        lunch: [
            {
                title: "Poulet et quinoa",
                calories: 550,
                description: "Filet de poulet grill√©, quinoa, brocolis vapeur, avocat",
                nutrients: "P : 40 g, G : 45 g, L : 20 g"
            },
            {
                title: "Salade de saumon",
                calories: 500,
                description: "Saumon grill√©, m√©lange de salades, quinoa, tomates cerises, vinaigrette l√©g√®re",
                nutrients: "P : 35 g, G : 30 g, L : 25 g"
            },
            {
                title: "Buddha bowl v√©g√©tarien",
                calories: 480,
                description: "Pois chiches, patate douce, avocat, quinoa, choux rouge",
                nutrients: "P : 22 g, G : 55 g, L : 18 g"
            },
            {
                title: "Tacos de poisson",
                calories: 520,
                description: "Poisson blanc grill√©, tortillas compl√®tes, salade, avocat, sauce l√©g√®re",
                nutrients: "P : 30 g, G : 40 g, L : 22 g"
            }
        ],
        snack: [
            {
                title: "Smoothie vert",
                calories: 250,
                description: "√âpinards, banane, lait d'amande, prot√©ine en poudre",
                nutrients: "P : 20 g, G : 30 g, L : 5 g"
            },
            {
                title: "Yaourt et fruits secs",
                calories: 200,
                description: "Yaourt grec nature, amandes, noix, miel",
                nutrients: "P : 15 g, G : 15 g, L : 10 g"
            },
            {
                title: "Muffin aux flocons d'avoine",
                calories: 220,
                description: "Flocons d‚Äôavoine, compote de pommes, ≈ìufs, dattes",
                nutrients: "P : 10 g, G : 25 g, L : 8 g"
            },
            {
                title: "Pomme et beurre d‚Äôamande",
                calories: 180,
                description: "Tranches de pomme avec beurre d‚Äôamande",
                nutrients: "P : 5 g, G : 20 g, L : 8 g"
            }
        ],
        dinner: [
            {
                title: "Dahl de lentilles",
                calories: 450,
                description: "Lentilles corail, lait de coco, √©pices, riz basmati",
                nutrients: "P : 25 g, G : 60 g, L : 12 g"
            },
            {
                title: "Filet de blanc de dinde",
                calories: 400,
                description: "Blanc de dinde, pur√©e de patate douce, haricots verts",
                nutrients: "P : 35 g, G : 40 g, L : 10 g"
            },
            {
                title: "Riz saut√© aux crevettes",
                calories: 480,
                description: "Riz complet, crevettes, petits pois, carottes, sauce soja l√©g√®re",
                nutrients: "P : 30 g, G : 50 g, L : 15 g"
            },
            {
                title: "Gratin de l√©gumes au tofu",
                calories: 430,
                description: "Courgettes, carottes, tofu, fromage all√©g√©, herbes de Provence",
                nutrients: "P : 28 g, G : 35 g, L : 17 g"
            }
        ]
    },
    lose: {
        breakfast: [
            {
                title: "≈íufs brouill√©s l√©gers",
                calories: 300,
                description: "2 ≈ìufs, blanc d'≈ìuf, √©pinards, champignons, pain complet",
                nutrients: "P : 20 g, G : 25 g, L : 10 g"
            },
            {
                title: "Smoothie bowl",
                calories: 280,
                description: "Fruits rouges, yaourt grec, graines de chia, flocons d'avoine",
                nutrients: "P : 15 g, G : 35 g, L : 8 g"
            },
            {
                title: "Toast avocat et ≈ìuf",
                calories: 270,
                description: "Pain complet, demi avocat, ≈ìuf poch√©",
                nutrients: "P : 14 g, G : 20 g, L : 11 g"
            },
            {
                title: "Pancakes l√©gers",
                calories: 290,
                description: "Farine compl√®te, ≈ìuf, yaourt nature, compote",
                nutrients: "P : 16 g, G : 30 g, L : 6 g"
            }
        ],
        lunch: [
            {
                title: "Salade de thon",
                calories: 450,
                description: "Thon naturel, salade verte, tomates, concombre, ≈ìuf dur, vinaigrette l√©g√®re",
                nutrients: "P : 35 g, G : 20 g, L : 15 g"
            },
            {
                title: "Poulet et l√©gumes r√¥tis",
                calories: 400,
                description: "Blanc de poulet, courgettes, poivrons, aubergines, huile d'olive",
                nutrients: "P : 40 g, G : 15 g, L : 12 g"
            },
            {
                title: "Bowl vegan minceur",
                calories: 420,
                description: "Tofu, riz complet, l√©gumes vapeur, graines de courge",
                nutrients: "P : 30 g, G : 35 g, L : 10 g"
            },
            {
                title: "Soupe repas",
                calories: 350,
                description: "Soupe de l√©gumes, lentilles, pain complet",
                nutrients: "P : 20 g, G : 30 g, L : 9 g"
            }
        ],
        snack: [
            {
                title: "Fromage blanc et fruits",
                calories: 150,
                description: "Fromage blanc 0%, pomme, cannelle",
                nutrients: "P : 15 g, G : 20 g, L : 0 g"
            },
            {
                title: "Fromage blanc entier, noix et graines",
                calories: 200,
                description: "Fromage blanc agr√©ment√© de noix et de graines, un encas riche et √©quilibr√©.",
                nutrients: "P : 10 g, G : 4 g, L : 15 g"
              },
            {
                title: "B√¢tonnets de l√©gumes",
                calories: 100,
                description: "Carottes, c√©leri, concombre, houmous l√©ger",
                nutrients: "P : 5 g, G : 10 g, L : 3 g"
            },
            {
                title: "Galettes de riz et thon",
                calories: 160,
                description: "Galettes de riz, thon au naturel",
                nutrients: "P : 12 g, G : 10 g, L : 5 g"
            },
            {
                title: "≈íuf dur et tomate",
                calories: 120,
                description: "≈íuf dur, tomate cerise, herbes",
                nutrients: "P : 10 g, G : 5 g, L : 7 g"
            }
        ],
        dinner: [
            {
                title: "Soupe et omelette",
                calories: 350,
                description: "Soupe de l√©gumes maison, omelette aux herbes",
                nutrients: "P : 25 g, G : 20 g, L : 12 g"
            },
            {
                title: "Cabillaud vapeur",
                calories: 300,
                description: "Filet de cabillaud, ratatouille, riz complet",
                nutrients: "P : 30 g, G : 25 g, L : 8 g"
            },
            {
                title: "Tofu et l√©gumes saut√©s",
                calories: 330,
                description: "Tofu, brocolis, champignons, sauce soja l√©g√®re",
                nutrients: "P : 20 g, G : 15 g, L : 12 g"
            },
            {
                title: "Mini Frittatas au fromage",
                calories: 150,
                description: "≈íufs battus avec fromage fondu, cuits en mini-moules pour une collation riche en prot√©ines.",
                nutrients: "P : 12 g, G : 0.7 g, L : 11 g"
              },
              {
                title: "Boulettes de viande fourr√©es au fromage",
                calories: 128,
                description: "Boulettes de b≈ìuf farcies au fromage, parfaites pour un ap√©ritif prot√©in√©.",
                nutrients: "P : 12.5 g, G : 0.2 g, L : 8.5 g"
              },
              {
                title: "M√©lange de graines (amandes, noix de cajou, graines om√©ga)",
                calories: 187,
                description: "Un encas nutritif √† base de noix et de graines riches en bons lipides.",
                nutrients: "P : 7 g, G : 6 g, L : 15 g"
              },
              {
                title: "Omelette aux √©pinards et feta",
                calories: 210,
                description: "≈íufs, √©pinards frais et feta pour un petit d√©jeuner sain et rassasiant.",
                nutrients: "P : 14 g, G : 2 g, L : 16 g"
              },
              {
                title: "Saumon grill√© √† l‚Äôhuile d‚Äôolive",
                calories: 250,
                description: "Pav√© de saumon grill√© √† l‚Äôhuile d‚Äôolive, riche en om√©ga-3.",
                nutrients: "P : 22 g, G : 0 g, L : 18 g"
              },
              {
                title: "Avocat farci au thon",
                calories: 220,
                description: "Demi-avocat garni de thon assaisonn√©, parfait pour une entr√©e riche en bons gras.",
                nutrients: "P : 11 g, G : 3 g, L : 18 g"
              },
              {
                title: "Salade de poulet, avocat, noix",
                calories: 320,
                description: "Morceaux de poulet, tranches d‚Äôavocat et cerneaux de noix sur lit de salade.",
                nutrients: "P : 24 g, G : 4 g, L : 23 g"
              },
              {
                title: "Chou-fleur r√¥ti au parmesan",
                calories: 110,
                description: "Chou-fleur r√¥ti avec du parmesan pour une garniture croustillante et l√©g√®re.",
                nutrients: "P : 5 g, G : 4 g, L : 8 g"
              },
              {
                title: "≈íufs cocotte au jambon",
                calories: 170,
                description: "≈íufs cuits au four avec cr√®me et d√©s de jambon pour une entr√©e gourmande.",
                nutrients: "P : 13 g, G : 1 g, L : 12 g"
              },
              
              {
                title: "Courgettes saut√©es au beurre",
                calories: 90,
                description: "Tranches de courgettes po√™l√©es au beurre pour une garniture simple et savoureuse.",
                nutrients: "P : 2 g, G : 3 g, L : 8 g"
              },
              {
                title: "Brochettes de crevettes marin√©es",
                calories: 120,
                description: "Crevettes marin√©es et grill√©es, √† servir en ap√©ritif ou en plat principal.",
                nutrients: "P : 15 g, G : 1 g, L : 6 g"
              },
              {
                title: "Po√™l√©e de champignons √† la cr√®me",
                calories: 130,
                description: "Champignons saut√©s √† la cr√®me pour accompagner une viande ou des ≈ìufs.",
                nutrients: "P : 4 g, G : 3 g, L : 10 g"
              },
              {
                title: "Carpaccio de b≈ìuf, huile d‚Äôolive",
                calories: 180,
                description: "Tranches fines de b≈ìuf cru, arros√©es d‚Äôhuile d‚Äôolive et parsem√©es de parmesan.",
                nutrients: "P : 18 g, G : 0 g, L : 11 g"
              },
              {
                title: "Salade de saumon fum√©, avocat",
                calories: 210,
                description: "Lamelles de saumon fum√© et tranches d‚Äôavocat sur lit de salade verte.",
                nutrients: "P : 14 g, G : 2 g, L : 16 g"
              },
              {
                title: "Tartelette aux ≈ìufs et bacon (sans p√¢te)",
                calories: 190,
                description: "Mini-tartelettes √† base d'≈ìufs et de bacon, id√©ales pour le brunch.",
                nutrients: "P : 12 g, G : 1 g, L : 15 g"
              },
              {
                title: "Poulet curry coco",
                calories: 250,
                description: "Blancs de poulet mijot√©s au lait de coco et √©pices.",
                nutrients: "P : 22 g, G : 3 g, L : 17 g"
              },
              {
                title: "Gratin de brocoli au fromage",
                calories: 150,
                description: "Brocoli gratin√© au fromage pour un accompagnement fondant et riche.",
                nutrients: "P : 8 g, G : 3 g, L : 11 g"
              },
              {
                title: "Sardines √† l‚Äôhuile d‚Äôolive",
                calories: 180,
                description: "Sardines en bo√Æte ou grill√©es √† l‚Äôhuile, source de prot√©ines et d‚Äôom√©ga-3.",
                nutrients: "P : 20 g, G : 0 g, L : 12 g"
              },
              {
                title: "Salade grecque (feta, olives, concombre)",
                calories: 170,
                description: "M√©lange m√©diterran√©en rafra√Æchissant et √©quilibr√©.",
                nutrients: "P : 7 g, G : 4 g, L : 13 g"
              },
              {
                title: "Rillettes de maquereau",
                calories: 160,
                description: "Tartinade de maquereau aux herbes et au fromage frais.",
                nutrients: "P : 13 g, G : 1 g, L : 11 g"
              },
            {
                title: "Salade d'√©peautre",
                calories: 310,
                description: "√âpeautre, tomates, f√©ta all√©g√©e, roquette",
                nutrients: "P : 18 g, G : 30 g, L : 9 g"
            }
        ]
    },
    gain: {
        breakfast: [
            {
                title: "Cr√™pes prot√©in√©es",
                calories: 600,
                description: "Cr√™pes √† la banane, ≈ìufs, flocons d'avoine, sirop d'√©rable, beurre de cacahu√®te",
                nutrients: "P : 30 g, G : 75 g, L : 20 g"
            },
            {
                title: "Porridge prot√©in√©",
                calories: 350,
                description: "Flocons d'avoine, lait d'amande, banane, noix et graines + WHEY pour un porridge sUUUUUUUper Power √©nerv√© üí™",
                nutrients: "P : 15 g, G : 50 g, L : 10 g"
            },
            {
                title: "Toast √† l'avocat",
                calories: 550,
                description: "Pain complet, avocat, ≈ìufs poch√©s, saumon fum√©",
                nutrients: "P : 25 g, G : 40 g, L : 30 g"
            },
            {
                title: "Bol granola maison",
                calories: 620,
                description: "Granola, lait entier, fruits, graines de tournesol",
                nutrients: "P : 25 g, G : 70 g, L : 22 g"
            },
            {
                title: "Fromage blanc entier, noix et graines",
                calories: 200,
                description: "Fromage blanc agr√©ment√© de noix et de graines, un encas riche et √©quilibr√©.",
                nutrients: "P : 10 g, G : 4 g, L : 15 g"
              },
            {
                title: "Omelette au fromage",
                calories: 580,
                description: "≈íufs, fromage r√¢p√©, pain de seigle, avocat",
                nutrients: "P : 35 g, G : 40 g, L : 28 g"
            }
        ],
        lunch: [
            {
                title: "Steak et pommes de terre",
                calories: 700,
                description: "Steak hach√© 5%, patates douces r√¥ties, haricots verts, sauce maison",
                nutrients: "P : 50 g, G : 60 g, L : 25 g"
            },
            {
                title: "P√¢tes au saumon",
                calories: 650,
                description: "P√¢tes compl√®tes, saumon frais, cr√®me l√©g√®re, brocolis",
                nutrients: "P : 40 g, G : 70 g, L : 20 g"
            },
            {
                title: "Bowl riz et poulet curry",
                calories: 680,
                description: "Poulet au curry, riz basmati, noix de cajou, l√©gumes grill√©s",
                nutrients: "P : 45 g, G : 65 g, L : 24 g"
            },
            {
                title: "Burger maison √©quilibr√©",
                calories: 720,
                description: "Pain complet, steak, cheddar, avocat, salade, sauce yaourt",
                nutrients: "P : 40 g, G : 60 g, L : 30 g"
            }
        ],
        snack: [
            {
                title: "Shake hypercalorique",
                calories: 400,
                description: "Lait entier, banane, beurre de cacahu√®te, flocons d'avoine, miel et pourquoi pas un peu WHEY!!!",
                nutrients: "P : 20 g, G : 50 g, L : 15 g"
            },
            {
                title: "Barres √©nerg√©tiques",
                calories: 350,
                description: "M√©lange de fruits secs, noix, graines et miel",
                nutrients: "P : 15 g, G : 40 g, L : 18 g"
            },
            {
                title: "Pain complet et fromage",
                calories: 300,
                description: "Pain aux c√©r√©ales, fromage frais, graines",
                nutrients: "P : 18 g, G : 30 g, L : 14 g"
            },
            {
                title: "Banane et lait chocolat√©",
                calories: 330,
                description: "Banane, lait entier, cacao en poudre non sucr√©",
                nutrients: "P : 14 g, G : 35 g, L : 12 g"
            }
        ],
        dinner: [
            {
                title: "Risotto aux champignons",
                calories: 600,
                description: "Riz arborio, champignons, parmesan, bouillon de l√©gumes",
                nutrients: "P : 25 g, G : 80 g, L : 20 g"
            },
            {
                title: "Curry de poulet",
                calories: 550,
                description: "Cuisse de poulet, curry, lait de coco, riz basmati",
                nutrients: "P : 40 g, G : 50 g, L : 25 g"
            },
            {
                title: "Gratin de p√¢tes au thon",
                calories: 640,
                description: "P√¢tes compl√®tes, thon, b√©chamel l√©g√®re, courgettes",
                nutrients: "P : 35 g, G : 70 g, L : 18 g"
            },
            {
                title: "Lasagnes maison",
                calories: 680,
                description: "Lasagnes √† la viande, l√©gumes, fromage, sauce tomate",
                nutrients: "P : 45 g, G : 60 g, L : 28 g"
            }
        ]
    }
};



        // Gestion du formulaire
        document.getElementById('profileForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // R√©cup√©ration des valeurs
            const age = parseInt(document.getElementById('age').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const height = parseFloat(document.getElementById('height').value);
            const activity = parseFloat(document.getElementById('activity').value);
            const gender = document.querySelector('input[name="gender"]:checked').value;
            const goal = document.getElementById('goal').value;
            
            // Calcul du m√©tabolisme de base (BMR)
            let bmr;
            if (gender === 'male') {
                bmr = 10 * weight + 6.25 * height - 5 * age + 5;
            } else {
                bmr = 10 * weight + 6.25 * height - 5 * age - 161;
            }
            
            // Calcul des besoins caloriques (TDEE)
            let tdee = bmr * activity;
            
            // Ajustement selon l'objectif
            if (goal === 'lose') {
                tdee = tdee * 0.85; // R√©duction de 15% pour la perte de poids
            } else if (goal === 'gain') {
                tdee = tdee * 1.15; // Augmentation de 15% pour la prise de poids
            }
            
            // Calcul des macronutriments
            const proteins = Math.round(weight * 1.8); // 1.8g de prot√©ine par kg de poids
            const proteinsCal = proteins * 4;
            
            let fats, fatsCal;
            if (goal === 'lose') {
                fats = Math.round((tdee * 0.25) / 9); // 25% des calories en lipides
                fatsCal = tdee * 0.25;
            } else {
                fats = Math.round((tdee * 0.3) / 9); // 30% des calories en lipides
                fatsCal = tdee * 0.3;
            }
            
            const carbsCal = tdee - proteinsCal - fatsCal;
            const carbs = Math.round(carbsCal / 4);
            
            // Calcul de l'eau recommand√©e
            const water = Math.round((weight * 0.035) * 10) / 10; // 35ml par kg de poids
            
            // Affichage des r√©sultats
            document.getElementById('caloriesResult').textContent = Math.round(tdee);
            document.getElementById('proteinsResult').textContent = proteins + 'g';
            document.getElementById('proteinsPercent').textContent = Math.round((proteinsCal / tdee) * 100);
            document.getElementById('carbsResult').textContent = carbs + 'g';
            document.getElementById('carbsPercent').textContent = Math.round((carbsCal / tdee) * 100);
            document.getElementById('fatsResult').textContent = fats + 'g';
            document.getElementById('fatsPercent').textContent = Math.round((fatsCal / tdee) * 100);
            document.getElementById('waterResult').textContent = water + 'L';
            
            // Ajustement des pourcentages de repas selon l'objectif
            if (goal === 'lose') {
                document.getElementById('breakfastPercent').textContent = '30';
                document.getElementById('lunchPercent').textContent = '35';
                document.getElementById('snackPercent').textContent = '10';
                document.getElementById('dinnerPercent').textContent = '25';
            } else if (goal === 'gain') {
                document.getElementById('breakfastPercent').textContent = '25';
                document.getElementById('lunchPercent').textContent = '30';
                document.getElementById('snackPercent').textContent = '20';
                document.getElementById('dinnerPercent').textContent = '25';
            } else {
                document.getElementById('breakfastPercent').textContent = '25';
                document.getElementById('lunchPercent').textContent = '35';
                document.getElementById('snackPercent').textContent = '15';
                document.getElementById('dinnerPercent').textContent = '25';
            }
            
            // Affichage des sections de r√©sultats
            document.getElementById('resultsSection').classList.remove('hidden');
            document.getElementById('menusSection').classList.remove('hidden');

            // Sauvegarde du profil dans localStorage
            const profileData = { age, weight, height, activity, gender, goal };
            localStorage.setItem('userProfile', JSON.stringify(profileData));
            
        function generateMenuCardHTML(menu, mealKey, mealLabel, totalCalories) {
            const percentage = Math.round((menu.calories / totalCalories) * 100);
            const [p, g, l] = menu.nutrients.split(', ');
            return `
            <div class="menu-card bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 transition duration-300">
                <div class="p-5">
                    <div class="flex justify-between items-start mb-3">
                        <h3 class="text-xl font-bold text-gray-800">${mealLabel}</h3>
                        <span class="bg-purple-100 text-purple-800 text-xs font-semibold px-2.5 py-0.5 rounded">${percentage}%</span>
                    </div>
                    <div class="h-32 mb-4 overflow-hidden rounded-lg">
                        <div class="w-full h-full bg-gradient-to-r from-${getRandomColor()}-400 to-${getRandomColor()}-500 flex items-center justify-center text-white font-bold text-xl">
                            ${menu.title.split(' ')[0]}
                        </div>
                    </div>
                    <h4 class="font-semibold text-lg mb-2">${menu.title}</h4>
                    <p class="text-gray-600 mb-4">${menu.description}</p>
                    <div class="flex justify-between text-sm">
                        <span class="text-blue-600 font-medium">${p}</span>
                        <span class="text-green-600 font-medium">${g}</span>
                        <span class="text-yellow-600 font-medium">${l}</span>
                    </div>
                    <div class="mt-4 pt-4 border-t border-gray-100 flex justify-between items-center">
                        <span class="text-gray-700 font-medium">${menu.calories} kcal</span>
                        <div class="flex gap-2">
                            <button class="text-purple-600 hover:text-purple-800 font-medium recipe-btn" data-recipe='${JSON.stringify(menu)}'>
                                <i class="fas fa-utensils mr-1"></i>Voir recette
                            </button>
                            <button class="text-gray-500 hover:text-gray-700 text-sm replace-btn" data-meal="${mealKey}" data-current-title="${menu.title}">
                                üîÅ Remplacer
                            </button>
                        </div>
                    </div>
                </div>
            </div>`;
        }

            
            // G√©n√©ration des menus
            generateMenus(goal, Math.round(tdee));
            
            // Scroll vers les r√©sultats
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        });
        
        // Fonction pour g√©n√©rer les menus
        function generateMenus(goal, calories) {
            const menuContainer = document.getElementById('menuContainer');
            menuContainer.innerHTML = '';
            
            const meals = ['breakfast', 'lunch', 'snack', 'dinner'];
            const mealNames = {
                breakfast: 'Petit-d√©jeuner',
                lunch: 'D√©jeuner',
                snack: 'Collation',
                dinner: 'D√Æner'
            };
            
            // S√©lection al√©atoire de menus pour chaque repas
            meals.forEach(meal => {
                const availableMenus = menusDatabase[goal][meal];
                const randomIndex = Math.floor(Math.random() * availableMenus.length);
                const selectedMenu = availableMenus[randomIndex];
                
                // Calcul du pourcentage de calories par rapport au total
                const caloriePercentage = Math.round((selectedMenu.calories / calories) * 100);
                
                // Cr√©ation de la carte de menu
                const menuCard = document.createElement('div');
                menuCard.className = 'menu-card bg-white rounded-xl shadow-md overflow-hidden border border-gray-100 transition duration-300';
                menuCard.innerHTML = `
                    <div class="p-5">
                        <div class="flex justify-between items-start mb-3">
                            <h3 class="text-xl font-bold text-gray-800">${mealNames[meal]}</h3>
                            <span class="bg-purple-100 text-purple-800 text-xs font-semibold px-2.5 py-0.5 rounded">${caloriePercentage}%</span>
                        </div>
                        <div class="h-32 mb-4 overflow-hidden rounded-lg">
                            <div class="w-full h-full bg-gradient-to-r from-${getRandomColor()}-400 to-${getRandomColor()}-500 flex items-center justify-center text-white font-bold text-xl">
                                ${selectedMenu.title.split(' ')[0]}
                            </div>
                        </div>
                        <h4 class="font-semibold text-lg mb-2">${selectedMenu.title}</h4>
                        <p class="text-gray-600 mb-4">${selectedMenu.description}</p>
                        <div class="flex justify-between text-sm">
                            <span class="text-blue-600 font-medium">${selectedMenu.nutrients.split(', ')[0]}</span>
                            <span class="text-green-600 font-medium">${selectedMenu.nutrients.split(', ')[1]}</span>
                            <span class="text-yellow-600 font-medium">${selectedMenu.nutrients.split(', ')[2]}</span>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-100 flex justify-between items-center">
                            <span class="text-gray-700 font-medium">${selectedMenu.calories} kcal</span>
                            <div class="flex gap-2">
                                <button class="text-purple-600 hover:text-purple-800 font-medium recipe-btn" data-recipe='${JSON.stringify(selectedMenu)}'>
                                    <i class="fas fa-utensils mr-1"></i>Voir recette
                                </button>
                                <button class="text-gray-500 hover:text-gray-700 text-sm replace-btn" data-meal="${meal}" data-current-title="${selectedMenu.title}">
                                    üîÅ Remplacer
                                </button>
                            </div>
                        </div>

                `;
                
                // Gestion du bouton "Voir recette"
                menuCard.querySelector('.recipe-btn').addEventListener('click', (e) => {
                    const recipe = JSON.parse(e.target.closest('button').dataset.recipe);
                    localStorage.setItem('selectedRecipe', JSON.stringify(recipe));
                    window.location.href = 'recette.html';
                });
                
                // Gestion du bouton "Remplacer"
                menuCard.querySelector('.replace-btn').addEventListener('click', (e) => {
                    const meal = e.target.dataset.meal;
                    const currentTitle = e.target.dataset.currentTitle;
                
                    const allOptions = menusDatabase[goal][meal];
                    let newOption;
                    do {
                        newOption = allOptions[Math.floor(Math.random() * allOptions.length)];
                    } while (newOption.title === currentTitle); // √©viter de reprendre le m√™me
                
                    // Remplace la carte actuelle
                    const newHTML = generateMenuCardHTML(newOption, meal, mealNames[meal], calories);
                    const wrapper = document.createElement('div');
                    wrapper.innerHTML = newHTML;
                    const newCard = wrapper.firstElementChild;
                
                    // Re-bind des √©v√©nements
                    newCard.querySelector('.recipe-btn').addEventListener('click', (e) => {
                        const recipe = JSON.parse(e.target.closest('button').dataset.recipe);
                        localStorage.setItem('selectedRecipe', JSON.stringify(recipe));
                        window.location.href = 'recette.html';
                    });
                
                    newCard.querySelector('.replace-btn').addEventListener('click', e.target.onclick);
                
                    menuContainer.replaceChild(newCard, menuCard);
                });


            });
        }
        
        // Fonction utilitaire pour obtenir une couleur al√©atoire
        function getRandomColor() {
            const colors = ['purple', 'blue', 'green', 'yellow', 'red', 'indigo', 'pink'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
    </script>
</body>
</html>
